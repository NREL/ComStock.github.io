---
layout: default
title: Building Stock Characterization and Upgrades Impact Workbook
parent: Resources
nav_order: 10
---

# How-to: Perform a commercial building stock characterization and upgrades impact analysis in Excel.

*This workbook template was developed using the ComStock 2024 Release 2 dataset. Keep in mind that some dataset attributes, such as column names and the list/order of upgrades, may change in future releases, and the template will need modifications to remain compatible.*

This workbook was developed to answer commonly asked questions about commercial buildings in a specific region or area. Example statements include:
-	**I want to understand what types/sizes of commercial buildings exist in my state and how they use energy.**
-	**I want to understand which upgrades will save the most energy in commercial buildings in my city.**
-	**I want to set achievable energy and emissions targets for commercial buildings in my jurisdiction.**

The first part of this workbook is a **“Building Stock Characterization”**. This refers to the process of assessing and analyzing the collective characteristics and attributes of a particular set of buildings within a defined region or area. The purpose of building stock characterization is to gain a comprehensive understanding of the existing building stock, enabling informed decisions about energy efficiency, sustainability, urban planning, and policy development. This analysis includes insights into the age distribution of buildings, the prevalence of different construction materials, the presence of energy-efficient technologies, and more. Additionally, the stock characterization includes data about energy consumption and emissions patterns—such as details by end-use—providing a complete picture of how energy is utilized and the associated environmental impacts.

The second part of this workbook is an **“Upgrade Impact Analysis”**. This refers to the process of evaluating various building upgrades against the baseline stock to compare the impacts of individual measures. ComStock’s 2024 Release 2 dataset contains 39 upgrades that span envelope, HVAC, lighting, equipment, and demand flexibility technologies. In this workbook, the impacts of each upgrade will be compared side-by-side for the same set of buildings within a defined region or area. This upgrade impact analysis can provide insights into which upgrades have the biggest energy or emissions impact in a specific region, as well as which upgrades are most effective in which building types. This can inform decisions around building performance targets, incentive program development, prioritization of buildings or upgrades for retrofit projects, and more.

Based on the insights generated by this analysis, policymakers, urban planners, and building owners can develop targeted interventions to enhance energy efficiency, sustainability, and other objectives.

For information about the workbook, including details about its content and how to use it responsibly, please refer to the [workbook documentation](../../../assets/files/BPS Automated Workflow – How it Works and How to Responsibly Use the Data.pdf).

To perform this analysis for your building stock, follow the steps below: 

1.  **Download the [Workbook Template][1].**
2.	**Download the [Data Download Script][2].** 
3.	**Open the script in a Python-compatible program.**
4.	**Modify the list of states and counties** you want to analyze in the “User Inputs” cell of the script. The list must be provided in the following format:
<br><br>{ 'state_abbreviation': ['county_code_1', 'county_code_2', 'county_code_3'] }
<br>Example: {'CO': ['G0800170', 'G0800330', 'G0800990']}
<br><br>You may include multiple states. To map county names to county codes, refer to the *special_tract_lookup_table.csv* located [here](https://oedi-data-lake.s3.amazonaws.com/nrel-pds-building-stock/end-use-load-profiles-for-us-building-stock/2024/comstock_amy2018_release_2/geographic_information/spatial_tract_lookup_table.csv).<br>
5.  **Specify the output location for the CSV file** in the “User Inputs” cell of the script. 
6.	**Run the script.** It will generate a CSV file at the specified output location. 
7.	**Open both the CSV file and Workbook Template.**
8.	**Prepare the data:** Select all data in the CSV file beginning at Cell B2 (do not include column headings). To do so: 
    1.  Click Cell A2, then press "Ctrl + Shift + Right Arrow," and "Ctrl + Shift + Down Arrow." 
    2.  Copy the selected data and paste it into the “2. Raw Data” tab of the Workbook Template, starting at Cell A2.
9.	**Refresh the workbook:** At the top of the Excel window, navigate to “Data” >> “Refresh All.” This will refresh all plots and tables using the newly pasted data. 
10.	**Explore the workbook:** Refer to this document for detailed explanations about the workbook and its tabs. 
11.	**Feedback:** If you encounter issues or have any suggestions, contact [ComStock@nrel.gov](mailto:ComStock@nrel.gov).

[1]:../../../assets/files/ComStock Impact Analysis - Empty Template.xlsx
[2]:../../../assets/files/download_annual_baseline_and_upgrade_for_CSIA_data.ipynb
